---
version: 0.2
# Daily scheduled job to pre-build a release baseline artifact.
env:
  variables:
    # CODEBUILD_ is a reserved namespace.
    CB_BIN_DIR: "./codebuild/bin"

# Doc for batch https://docs.aws.amazon.com/codebuild/latest/userguide/batch-build-buildspec.html#build-spec.batch.build-list
batch:
  build-graph:
    - identifier: s2nIntegrationv2WellKnownEndpointsBaseline
      env:
        privileged-mode: true
        compute-type: BUILD_GENERAL1_LARGE
        variables:
          INTEGV2_TEST: test_well_known_endpoints

phases:
  install:
    runtime-versions:
      python: 3.x
    commands:
      - |
        if [ -d "third-party-src" ]; then
          cd third-party-src;
        fi
      - $CB_BIN_DIR/install_ubuntu_dependencies.sh
  build:
    commands:
      - $CB_BIN_DIR/criterion_baseline.sh