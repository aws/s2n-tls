
include "HMAC/spec/verify_HMAC.saw";

/*
 * The sha_bad_magic_mod patch changes the highest_32_bit value in s2n_hmac_update from 4294949760 to 4294949761. To
 * ensure SAW tests this function with the correct values when this patch is applied, the highest_32_bit value is
 * increased in SAW as well, via this config.
 */
let sha256_bad_magic_mod_cfg =
  { name            = "SHA256_bad_magic_mod"
  , hmac_alg        = {{ S2N_HMAC_SHA256 }}
  , digest_size     = 32
  , block_size      = 64
  , hash_block_size = 64
  , highest_32_bit  = 4294949761
  };

verify_s2n_hmac_at_config sha256_bad_magic_mod_cfg;
