//Constants.cry Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0

///////////////////////////////////////////////////////////////////////////////

module shared::Constants where

///////////////////////////////////////////////////////////////////////////////

type uchar = [8]
type ity = [32]

// NOTE: The following constants are dervied from config.h

NWORDS_FIELD = 8
p503_ZERO_WORDS = 3
g_RADIX = 64
g_LOG2RADIX = 6

// NOTE: The following constants are dervied from P503_internal.h

g_NBITS_FIELD = 503
g_MAXBITS_FIELD = 512
g_MAXWORDS_FIELD = ((g_MAXBITS_FIELD+g_RADIX-1)/g_RADIX)
g_NWORDS64_FIELD = ((g_NBITS_FIELD+63)/64)

g_NBITS_ORDER = 256
g_NWORDS_ORDER = ((g_NBITS_ORDER+g_RADIX-1)/g_RADIX)
g_NWORDS64_ORDER = ((g_NBITS_ORDER+63)/64)
g_MAXBITS_ORDER = g_NBITS_ORDER
g_MAXWORDS_ORDER = ((g_MAXBITS_ORDER+g_RADIX-1)/g_RADIX)

g_ALICE = 0
g_BOB = 1
g_OALICE_BITS = 250
g_OBOB_BITS  = 253
g_OBOB_EXPON = 159
g_MASK_ALICE = 0x03
g_MASK_BOB = 0x0F

g_PARAM_A = 0
g_PARAM_C = 1

g_MAX_INT_POINTS_ALICE =  7
g_MAX_INT_POINTS_BOB =  8
g_MAX_Alice =  125
g_MAX_Bob = 159
g_MSG_BYTES = 24
g_SECRETKEY_A_BYTES = (g_OALICE_BITS + 7) / 8
g_SECRETKEY_B_BYTES = (g_OBOB_BITS + 7) / 8
g_FP2_ENCODED_BYTES = 2*((g_NBITS_FIELD + 7) / 8)
c_zero_NWORDS_FIELD = [0,0,0,0,0,0,0,0]

g_CRYPTO_SECRETKEYBYTES = 434
g_CRYPTO_PUBLICKEYBYTES = 378
g_CRYPTO_BYTES = 16
g_CRYPTO_CIPHERTEXTBYTES = 402
n_cipherMsg =  g_CRYPTO_CIPHERTEXTBYTES + g_MSG_BYTES  // 402+24 -> 426
n_pubMsg = g_CRYPTO_PUBLICKEYBYTES + g_MSG_BYTES // 378 + 24 -> 402

type g_strat_Bob_ty = [158] ity
(g_strat_Bob : g_strat_Bob_ty) =
    [ 71, 38, 21, 13, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 5, 4
    , 2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1
    , 4, 2, 1, 1, 1, 2, 1, 1, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4
    , 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1
    , 1, 33, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1
    , 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1
    , 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2
    , 1, 1, 2, 1, 1 ]

type g_strat_Alice_ty = [124] ity
(g_strat_Alice : g_strat_Alice_ty) =
    [ 61, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1
    , 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2
    , 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 29, 16
    , 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1
    , 4, 2, 1, 1, 2, 1, 1, 13, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1
    , 5, 4, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1 ]

pub_ty_add : [378]uchar -> Integer -> [378]uchar
pub_ty_add c i = error" here"

pubMsg_ty_add : [402]uchar -> Integer -> [402]uchar
pubMsg_ty_add c i = error" here"

A_gen =
    [ 0xE7EF4AA786D855AF, 0xED5758F03EB34D3B, 0x09AE172535A86AA9, 0x237B9CC07D622723
    , 0xE3A284CBA4E7932D, 0x27481D9176C5E63F, 0x6A323FF55C6E71BF, 0x002ECC31A6FB8773
    , 0x64D02E4E90A620B8, 0xDAB8128537D4B9F1, 0x4BADF77B8A228F98, 0x0F5DBDF9D1FB7D1B
    , 0xBEC4DB288E1A0DCC, 0xE76A8665E80675DB, 0x6D6F252E12929463, 0x003188BD1463FACC
    , 0xB79D41025DE85D56, 0x0B867DA9DF169686, 0x740E5368021C827D, 0x20615D72157BF25C
    , 0xFF1590013C9B9F5B, 0xC884DCADE8C16CEA, 0xEBD05E53BF724E01, 0x0032FEF8FDA5748C
    , 0x12E2E849AA0A8006, 0x41CF47008635A1E8, 0x9CD720A70798AED7, 0x42A820B42FCF04CF
    , 0x7BF9BAD32AAE88B1, 0xF619127A54090BBE, 0x1CB10D8F56408EAA, 0x001D6B54C3C0EDEB
    , 0x34DB54931CBAAC36, 0x420A18CB8DD5F0C4, 0x32008C1A48C0F44D, 0x3B3BA772B1CFD44D
    , 0xA74B058FDAF13515, 0x095FC9CA7EEC17B4, 0x448E829D28F120F8, 0x00261EC3ED16A489 ]

B_gen =
    [ 0x7EDE37F4FA0BC727, 0xF7F8EC5C8598941C, 0xD15519B516B5F5C8, 0xF6D5AC9B87A36282
    , 0x7B19F105B30E952E, 0x13BD8B2025B4EBEE, 0x7B96D27F4EC579A2, 0x00140850CAB7E5DE
    , 0x7764909DAE7B7B2D, 0x578ABB16284911AB, 0x76E2BFD146A6BF4D, 0x4824044B23AA02F0
    , 0x1105048912A321F3, 0xB8A2E482CF0F10C1, 0x42FF7D0BE2152085, 0x0018E599C5223352
    , 0x4256C520FB388820, 0x744FD7C3BAAF0A13, 0x4B6A2DDDB12CBCB8, 0xE46826E27F427DF8
    , 0xFE4A663CD505A61B, 0xD6B3A1BAF025C695, 0x7C3BB62B8FCC00BD, 0x003AFDDE4A35746C
    , 0x75601CD1E6C0DFCB, 0x1A9007239B58F93E, 0xC1F1BE80C62107AC, 0x7F513B898F29FF08
    , 0xEA0BEDFF43E1F7B2, 0x2C6D94018CBAE6D0, 0x3A430D31BCD84672, 0x000D26892ECCFE83
    , 0x1119D62AEA3007A1, 0xE3702AA4E04BAE1B, 0x9AB96F7D59F990E7, 0xF58440E8B43319C0
    , 0xAF8134BEE1489775, 0xE7F7774E905192AA, 0xF54AE09308E98039, 0x001EF7A041A86112 ]
