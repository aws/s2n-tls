[tox]
envlist = py39
skipsdist = True

[testenv]
# install pytest in the virtualenv where commands will be executed
setenv = S2N_INTEG_TEST = 1
passenv = DYLD_LIBRARY_PATH LD_LIBRARY_PATH OQS_OPENSSL_1_1_1_INSTALL_DIR PYTEST_XDIST_WORKER_COUNT HOME TOX_TEST_NAME
deps =
    pep8
    pytest==5.3.5
    pytest-xdist==1.34.0
commands =
    pytest -n=1 -o log_cli=true  --cache-clear -rpfs \
        --log-level=INFO --debug \
        --provider-version={env:S2N_LIBCRYPTO} \
        --fips-mode={env:S2N_TEST_IN_FIPS_MODE:"0"} \
        --no-pq={env:S2N_NO_PQ:"0"} \
        {env:TOX_TEST_NAME:""}
